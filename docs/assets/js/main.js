"use strict";const searchInput=document.querySelector(".js_search_input"),searchBtn=document.querySelector(".js_search_btn"),listCharactersElement=document.querySelector(".js_list_characters"),sectionFavoritesElement=document.querySelector(".js_section_favorites"),listFavoritesElement=document.querySelector(".js_list_favorites");let allCharacters=JSON.parse(localStorage.getItem("allCharactersLS")),foundCharacters=[],favCharacters=JSON.parse(localStorage.getItem("favCharactersLS"));const classListItemAllCharacters="js_character_article",classListItemFavCharacters="js_favorite_article";function fetchCharacters(){fetch("https://breakingbadapi.com/api/characters").then(e=>e.json()).then(e=>{allCharacters=e,saveToLocal(allCharacters,"allCharactersLS"),renderCharacters(allCharacters,listCharactersElement,"js_character_article")})}function fetchSearchCharacters(e){fetch("https://breakingbadapi.com/api/characters?name="+e).then(e=>e.json()).then(e=>{foundCharacters=e,renderCharacters(foundCharacters,listCharactersElement,"js_character_article")})}function renderOneCharacter(e,a){let t="";return t=-1===favCharacters.findIndex(a=>a.char_id===e.char_id)?`<li class="item">\n  <article id="${e.char_id}" class="item__article ${a}">\n    <img class="item__article__img" src="${e.img}" alt="${e.name}">\n    <h3 class="item__article__title">${e.name}</h3>\n    <p class="item__article__text">${e.status}</p>\n  </article>\n</li>`:`<li class="item">\n  <article id="${e.char_id}" class="item__article ${a} favorite">\n    <img class="item__article__img" src="${e.img}" alt="${e.name}">\n    <h3 class="item__article__title">${e.name}</h3>\n    <p class="item__article__text">${e.status}</p>\n  </article>\n</li>`,t}function renderCharacters(e,a,t){a.innerHTML="";for(const r of e)a.innerHTML+=renderOneCharacter(r,t);addCharacterListeners(),addFavoriteListeners()}function handleSearchClick(e){e.preventDefault();const a=searchInput.value.toLowerCase();allCharacters?(foundCharacters=allCharacters.filter(e=>e.name.toLowerCase().includes(a)),renderCharacters(foundCharacters,listCharactersElement,"js_character_article")):fetchSearchCharacters(a)}function handleInput(e){e.preventDefault();searchInput.value||handleSearchClick(e)}function addCharacterListeners(){const e=document.querySelectorAll(".js_character_article");for(const a of e)a.addEventListener("click",handleCharactersClick)}function addFavoriteListeners(){const e=document.querySelectorAll(".js_favorite_article");for(const a of e)a.addEventListener("click",handleFavoritesClick)}function handleCharactersClick(e){const a=parseInt(e.currentTarget.id),t=allCharacters.find(e=>e.char_id===a),r=favCharacters.findIndex(e=>e.char_id===a);-1===r?(favCharacters.push(t),e.currentTarget.classList.add("favorite")):(favCharacters.splice(r,1),e.currentTarget.classList.remove("favorite")),localStorage.setItem("favCharactersLS",JSON.stringify(favCharacters)),favCharacters.length>0?(sectionFavoritesElement.classList.remove("hidden"),renderCharacters(favCharacters,listFavoritesElement,"js_favorite_article")):sectionFavoritesElement.classList.add("hidden")}function handleFavoritesClick(e){handleCharactersClick(e),renderCharacters(allCharacters,listCharactersElement,"js_character_article")}function saveToLocal(e,a){localStorage.setItem(a,JSON.stringify(e))}favCharacters&&favCharacters.length>0?(favCharacters=JSON.parse(localStorage.getItem("favCharactersLS")),sectionFavoritesElement.classList.remove("hidden"),renderCharacters(favCharacters,listFavoritesElement,"js_favorite_article")):(favCharacters=[],sectionFavoritesElement.classList.add("hidden")),allCharacters?renderCharacters(allCharacters,listCharactersElement,"js_character_article"):fetchCharacters(),searchBtn.addEventListener("click",handleSearchClick),searchInput.addEventListener("input",handleInput);