"use strict";const searchInput=document.querySelector(".js_search_input"),searchBtn=document.querySelector(".js_search_btn"),listCharactersElement=document.querySelector(".js_list_characters"),sectionFavoritesElement=document.querySelector(".js_section_favorites"),listFavoritesElement=document.querySelector(".js_list_favorites"),favMessage=document.querySelector(".js_fav_message"),btnGoFav=document.querySelector(".js_button_gofav");let allCharacters=JSON.parse(localStorage.getItem("allCharactersLS")),foundCharacters=[],favCharacters=JSON.parse(localStorage.getItem("favCharactersLS"));const classListItemAllCharacters="js_character_article",classListItemFavCharacters="js_favorite_article",classRemoveIcon="js_remove_favorite";function fetchCharacters(){fetch("https://breakingbadapi.com/api/characters").then(e=>e.json()).then(e=>{allCharacters=e,saveToLocal(allCharacters,"allCharactersLS"),renderCharacters(allCharacters,listCharactersElement,"js_character_article")})}function fetchSearchCharacters(e){fetch("https://breakingbadapi.com/api/characters?name="+e).then(e=>e.json()).then(e=>{foundCharacters=e,renderCharacters(foundCharacters,listCharactersElement,"js_character_article")})}function renderOneCharacter(e,a){let t="";return t=-1===favCharacters.findIndex(a=>a.char_id===e.char_id)?`<li class="item">\n  <article id="${e.char_id}" class="item__article ${a}">\n    <h3 class="item__article__title">${e.name}</h3>\n    <img class="item__article__img" src="${e.img}" alt="Photo of ${e.name}">\n    <p class="item__article__text">${e.status}</p>\n  </article>\n</li>`:`<li class="item">\n  <article id="${e.char_id}" class="item__article ${a} favorite">\n    <h3 class="item__article__title">${e.name}</h3>\n    <img class="item__article__img" src="${e.img}" alt="${e.name}">\n    <p class="item__article__text">${e.status}</p>\n  </article>\n</li>`,t}function renderCharacters(e,a,t){a.innerHTML="";for(const r of e)a.innerHTML+=renderOneCharacter(r,t);addCharacterListeners()}function renderOneFavorite(e,a){let t="";return t=`<li class="item">\n  <article id="${e.char_id}" class="item__article ${a} favorite">\n    <div class="item__article__remove js_remove_favorite">\n      <i class="fa-solid fa-circle-xmark item__article__remove__icon"></i>\n    </div>\n    <h3 class="item__article__title">${e.name}</h3>\n    <img class="item__article__img" src="${e.img}" alt="${e.name}">\n    <p class="item__article__text">${e.status}</p>\n  </article>\n</li>`,t}function renderFavorites(e,a,t){a.innerHTML="";for(const r of e)a.innerHTML+=renderOneFavorite(r,t);addFavoriteListeners()}function handleSearchClick(e){e.preventDefault();const a=searchInput.value.toLowerCase();allCharacters?(foundCharacters=allCharacters.filter(e=>e.name.toLowerCase().includes(a)),renderCharacters(foundCharacters,listCharactersElement,"js_character_article")):fetchSearchCharacters(a)}function handleInput(e){e.preventDefault();searchInput.value||handleSearchClick(e)}function addCharacterListeners(){const e=document.querySelectorAll(".js_character_article");for(const a of e)a.addEventListener("click",handleCharactersClick)}function addFavoriteListeners(){const e=document.querySelectorAll(".js_remove_favorite");for(const a of e)a.addEventListener("click",handleFavoritesClick)}favCharacters&&favCharacters.length>0?(sectionFavoritesElement.classList.remove("hidden"),btnGoFav.classList.remove("hidden"),renderFavorites(favCharacters,listFavoritesElement,"js_favorite_article")):(favCharacters=[],sectionFavoritesElement.classList.add("hidden"),btnGoFav.classList.add("hidden")),allCharacters?renderCharacters(allCharacters,listCharactersElement,"js_character_article"):fetchCharacters(),searchBtn.addEventListener("click",handleSearchClick),searchInput.addEventListener("input",handleInput);const removeMsg=()=>{favMessage.classList.add("hidden")};function handleCharactersClick(e){const a=e.currentTarget,t=parseInt(a.id),r=allCharacters.find(e=>e.char_id===t),s=favCharacters.findIndex(e=>e.char_id===t);-1===s?(favCharacters.push(r),a.classList.add("favorite"),favMessage.classList.remove("hidden"),setTimeout(removeMsg,3e3)):(favCharacters.splice(s,1),a.classList.remove("favorite")),localStorage.setItem("favCharactersLS",JSON.stringify(favCharacters)),favCharacters.length>0?(sectionFavoritesElement.classList.remove("hidden"),btnGoFav.classList.remove("hidden"),renderFavorites(favCharacters,listFavoritesElement,"js_favorite_article")):(sectionFavoritesElement.classList.add("hidden"),btnGoFav.classList.add("hidden"))}function handleFavoritesClick(e){const a=e.currentTarget.parentElement,t=parseInt(a.id),r=allCharacters.find(e=>e.char_id===t),s=favCharacters.findIndex(e=>e.char_id===t);-1===s?(favCharacters.push(r),a.classList.add("favorite")):(favCharacters.splice(s,1),a.classList.remove("favorite")),localStorage.setItem("favCharactersLS",JSON.stringify(favCharacters)),favCharacters.length>0?(sectionFavoritesElement.classList.remove("hidden"),btnGoFav.classList.remove("hidden"),renderFavorites(favCharacters,listFavoritesElement,"js_favorite_article")):(sectionFavoritesElement.classList.add("hidden"),btnGoFav.classList.add("hidden")),renderCharacters(allCharacters,listCharactersElement,"js_character_article")}function saveToLocal(e,a){localStorage.setItem(a,JSON.stringify(e))}